---
---
<div id="json-formatter">
  <div class="flex flex-col space-y-4">
    <div>
      <label for="json-input" class="block text-sm font-medium text-light-accent dark:text-dark-muted">JSON Input</label>
      <textarea id="json-input" rows="10" class="w-full p-2 border rounded bg-light-surface dark:bg-dark-surface text-light-accent dark:text-dark-muted border-light-border dark:border-dark-border"></textarea>
    </div>
    <button id="format-btn" class="bg-light-accent dark:bg-dark-accent text-white font-bold py-2 px-4 rounded shadow-glow">
      Format JSON
    </button>
    <div id="result-container" class="mt-4 result-pop-in">
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const formatBtn = document.getElementById('format-btn');
    const jsonInput = document.getElementById('json-input');
    const resultContainer = document.getElementById('result-container');

    function createResult(result) {
      resultContainer.innerHTML = `
        <div class="relative">
          <textarea readOnly id="result-output" class="w-full p-2 border rounded bg-light-surface dark:bg-dark-surface text-light-accent dark:text-dark-muted border-light-border dark:border-dark-border" rows="10">${result}</textarea>
          <button id="copy-btn" class="absolute top-2 right-2 text-light-accent dark:text-dark-muted hover:text-light-accent dark:hover:text-white">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 012-2h4a2 2 0 012 2v1M8 5a2 2 0 002 2h4a2 2 0 002-2" />
            </svg>
            <span class="copy-tooltip absolute -top-8 -right-2 bg-gray-800 text-white text-xs rounded py-1 px-2">Copy</span>
          </button>
        </div>
      `;

      const copyBtn = document.getElementById('copy-btn');
      const resultOutput = document.getElementById('result-output');
      const copyTooltip = document.querySelector('.copy-tooltip');

      copyBtn.addEventListener('click', () => {
        navigator.clipboard.writeText(resultOutput.value).then(() => {
          copyBtn.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
          `;
          copyTooltip.textContent = 'Copied!';
          setTimeout(() => {
            copyBtn.innerHTML = `
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 012-2h4a2 2 0 012 2v1M8 5a2 2 0 002 2h4a2 2 0 002-2" />
              </svg>
            `;
            copyTooltip.textContent = 'Copy';
          }, 2000);
        });
      });
    }

    formatBtn.addEventListener('click', () => {
      try {
        const formatted = JSON.stringify(JSON.parse(jsonInput.value), null, 2);
        createResult(formatted);
      } catch (error) {
        resultContainer.innerHTML = `<div class="p-4 text-red-700 bg-red-100 border border-red-400 rounded">${error}</div>`;
      }
    });
  });
</script>
